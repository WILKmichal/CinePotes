meta {
  name: POST /lists
  type: http
  seq: 2
}

post {
  url: {{URL}}/lists
  body: json
  auth: bearer
}

headers {
  Content-Type: application/json
}

auth:bearer {
  token: {{ACCESS_TOKEN}}
}

body:json {
  {
    "nom": "Ma liste de test"
  }
}

script:pre-request {
  await bru.runRequest("04-Auth/POST_auth_login");
}

script:post-response {
  if (res.body && res.body.id) {
    bru.setEnvVar("LIST_ID", res.body.id);
  }
}

tests {
  test("Status code is 201", function() {
    expect(res.getStatus()).to.equal(201);
  });
  
  test("Response contains id", function() {
    expect(res.body).to.have.property('id');
  });
  
  test("Response contains nom", function() {
    expect(res.body).to.have.property('nom');
    expect(res.body.nom).to.equal('Ma liste de test');
  });
}
